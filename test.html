


<link rel="stylesheet" href="css/product-cart.css">
<div class="slider-container">
    <button class="nav-btn prev-btn" onclick="scrollSlider(-1)">⬅</button>
    <div class="slider" id="book-slider"></div>
    <button class="nav-btn next-btn" onclick="scrollSlider(1)">➡</button>
</div>

    

<script>
    let isDown = false;
    let startX;
    let scrollLeft;
    const slider = document.getElementById('book-slider');

    async function fetchBooks() {
        try {
            let response = await fetch('http://127.0.0.1:8000/books/');
            let books = await response.json();
            let repeatedBooks = [...books, ...books];

            slider.innerHTML = ''; // ابتدا محتوای قبلی پاک می‌شود
            repeatedBooks.forEach(product => {
                let productDiv = document.createElement('div');
                productDiv.classList.add('product-card');
                productDiv.innerHTML = `
                    <img src="${product.cover_image}" alt="${product.title}" style="width: 100px; height: 150px;">
                    <p id="discount">${product.discount} تومان</p>
                    <p>${product.price} تومان</p>
                    <a href="detail.html?id=${product.id}" class="view-details">مشاهده جزئیات</a>
                `;
                slider.appendChild(productDiv);
            });
        } catch (error) {
            console.error('خطا در دریافت داده‌ها:', error);
        }
    }

    function scrollSlider(direction) {
        let scrollAmount = 500;
        slider.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
    }

    function checkInfiniteScroll() {
        let totalWidth = slider.scrollWidth;
        let currentScroll = slider.scrollLeft;
    }

    slider.addEventListener('scroll', checkInfiniteScroll);

    slider.addEventListener('mousedown', (e) => {
        isDown = true;
        slider.classList.add('active');
        startX = e.pageX - slider.offsetLeft;
        scrollLeft = slider.scrollLeft;
        slider.style.cursor = "grabbing";
    });

    slider.addEventListener('mouseleave', () => {
        isDown = false;
        slider.classList.remove('active');
        slider.style.cursor = "grab";
    });

    slider.addEventListener('mouseup', () => {
        isDown = false;
        slider.classList.remove('active');
        slider.style.cursor = "grab";
    });

    slider.addEventListener('mousemove', (e) => {
        if (!isDown) return; // اگر ماوس را پایین نگه نداریم، حرکت نخواهد کرد
        e.preventDefault();
        const x = e.pageX - slider.offsetLeft;
        const walk = (x - startX); // مقدار حرکت ماوس برای جابجایی اسلایدر
        slider.scrollLeft = scrollLeft - walk; // جابجایی اسلایدر به اندازه حرکت ماوس
    });

    fetchBooks();
</script>
